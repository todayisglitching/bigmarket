{% extends "marketplace/base.html" %}

{% block title %}Мои продукты | BigMarket{% endblock %}

{% block content %}
<div class="mb-6 flex items-center justify-between">
  <div>
    <h1 class="text-3xl font-semibold tracking-tight text-white">Мои продукты</h1>
    <p class="text-sm text-white/60">Управление вашими продуктами</p>
  </div>
  <a href="{% url 'seller_product_create' %}" class="rounded-lg bg-blue-700 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-800 transition">
    + Создать продукт
  </a>
</div>

<!-- Фильтры -->
<div class="mb-6 flex gap-2">
  <a href="?status=all" class="rounded-lg px-4 py-2 text-sm font-semibold transition {% if status_filter == 'all' %}bg-blue-700 text-white{% else %}border border-white/10 text-white/60 hover:border-white{% endif %}">
    Все
  </a>
  <a href="?status=checked" class="rounded-lg px-4 py-2 text-sm font-semibold transition {% if status_filter == 'checked' %}bg-green-700 text-white{% else %}border border-white/10 text-white/60 hover:border-white{% endif %}">
    Проверенные
  </a>
  <a href="?status=unchecked" class="rounded-lg px-4 py-2 text-sm font-semibold transition {% if status_filter == 'unchecked' %}bg-yellow-700 text-white{% else %}border border-white/10 text-white/60 hover:border-white{% endif %}">
    На проверке
  </a>
</div>

<!-- Список продуктов -->
<section>
  <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
    {% for product in products %}
      <article class="flex flex-col rounded-lg border border-white/10 bg-neutral-900 p-4 shadow-sm">
        <div class="mb-3 flex aspect-square w-full items-center justify-center overflow-hidden rounded-lg bg-neutral-800">
          {% if product.product_photos.all %}
            <img src="{{ product.product_photos.all.0.photo.url }}" alt="{{ product.title }}" class="h-full w-full object-cover"/>
          {% elif product.thumbnail %}
            <img src="{{ product.thumbnail.url }}" alt="{{ product.title }}" class="h-full w-full object-cover"/>
          {% else %}
            <span class="text-sm text-white/50">Нет фото</span>
          {% endif %}
        </div>
        <div class="flex-1 space-y-2">
          <h3 class="text-lg font-semibold text-white">
            <a href="{% url 'product_detail' product.id %}" class="hover:text-blue-400">{{ product.title }}</a>
          </h3>
          <p class="text-sm text-white/60 line-clamp-2">{{ product.description|truncatewords:15 }}</p>
          <div class="flex items-center justify-between">
            <span class="text-lg font-semibold text-white">{{ product.price }} ₽</span>
            <span class="text-sm text-white/60">Остаток: {{ product.stock }} шт.</span>
          </div>
          <div class="flex items-center justify-between">
            {% if product.checked %}
              <span class="rounded-full bg-green-900/50 px-2 py-1 text-xs text-green-400">Проверен</span>
            {% else %}
              <span class="rounded-full bg-yellow-900/50 px-2 py-1 text-xs text-yellow-400">На проверке</span>
            {% endif %}
            <a href="{% url 'seller_product_edit' product.id %}" class="rounded-lg bg-blue-700 px-3 py-1 text-xs font-semibold text-white hover:bg-blue-800">
              Редактировать
            </a>
          </div>
        </div>
      </article>
    {% empty %}
      <div class="col-span-full rounded-lg border border-white/10 bg-neutral-900 p-8 text-center">
        <p class="text-white/60">Нет продуктов</p>
        <a href="{% url 'seller_product_create' %}" class="mt-4 inline-block rounded-lg bg-blue-700 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-800">
          Создать первый продукт
        </a>
      </div>
    {% endfor %}
  </div>
</section>
{% endblock %}
