{% extends "marketplace/base.html" %}

{% block title %}Каталог | BigMarket{% endblock %}

{% block content %}
<div class="space-y-4 text-white">
  <!-- Promo Section: заглушка -->
  <section class="relative rounded-xl bg-gradient-to-r from-blue-700 via-blue-600 to-purple-700 p-8 flex flex-col md:flex-row gap-8 items-center overflow-hidden">
    <div class="z-10 max-w-lg space-y-4">
      <h2 class="text-3xl md:text-4xl font-bold">Тестовая промо-секция для маркетплейса</h2>
      <p class="text-lg text-white/90">Здесь могла бы быть ваша акция, баннер или краткое описание возможностей сайта. Пока что это заглушка для визуального теста.</p>
    </div>
    <div class="flex-shrink-0 w-72 h-48 md:w-96 md:h-56 z-10">
      <img src="https://img.freepik.com/free-vector/flat-design-supermarket-background_23-2149143246.jpg?w=1380&t=st=1702206742~exp=1702207342~hmac=2deaa6d3a0fbb0380c5eaaae9692d1832d3e60b7b965dc6ab2f2291fe0cec4eb" alt="Промо-картинка с Freepik" class="rounded-xl shadow-lg w-full h-full object-cover border border-white/10"/>
      <span class="absolute right-4 bottom-2 z-20 text-xs text-white/50">Freepik</span>
    </div>
    <div class="absolute inset-0 bg-gradient-to-r from-blue-900/40 via-transparent to-purple-900/40 pointer-events-none"></div>
  </section>

  <!-- Система поиска -->
  <section class="w-full py-2">
  <form action="#" method="get" class="w-full flex gap-2">
    <input type="search" name="q" placeholder="Найти товар..."
      class="w-full px-4 py-2 rounded-lg bg-neutral-950 border border-neutral-800 focus:border-blue-400 focus:ring-1 focus:ring-blue-400 text-white placeholder:text-white/40 outline-none transition"
      autocomplete="off"
    >
    <button type="submit" class="px-5 py-2 rounded-lg bg-blue-700 text-white font-semibold hover:bg-blue-800 transition">
      Поиск
    </button>
  </form>
</section>

  <section>
    <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
      {% for product in products %}
        <article class="flex h-full flex-col justify-between rounded-lg bg-neutral-900 p-4 shadow-md hover:bg-neutral-800 transition">
          <div class="space-y-3">
            <div class="flex items-center justify-center mb-1 overflow-hidden rounded-lg">
              {% if product.product_photos.all %}
                <img src="{{ product.product_photos.all.0.photo.url }}" alt="{{ product.title }}" class="w-24 h-24 object-cover bg-neutral-800 rounded-lg shadow-inner"/>
              {% elif product.thumbnail %}
                <img src="{{ product.thumbnail.url }}" alt="{{ product.title }}" class="w-24 h-24 object-cover bg-neutral-800 rounded-lg shadow-inner"/>
              {% else %}
                <div class="w-24 h-24 flex items-center justify-center bg-neutral-800 rounded-lg text-white/50 text-xs">Нет фото</div>
              {% endif %}
            </div>
            <div class="space-y-1">
              {% if product.tags.all %}
                <p class="text-xs uppercase tracking-wide text-white/50">
                  {% for tag in product.tags.all|slice:":1" %}{{ tag.tagtitle }}{% endfor %}
                </p>
              {% endif %}
              <h3 class="text-lg font-semibold leading-snug">
                <a href="{% url 'product_detail' product.id %}" class="hover:text-white">{{ product.title }}</a>
              </h3>
              <p class="text-sm text-white/60 line-clamp-2">{{ product.description }}</p>
            </div>
          </div>
          <div class="mt-3 space-y-2">
            <div class="flex items-center justify-between">
              <div class="text-lg font-semibold text-white">{{ product.price }} ₽</div>
              {% if product.stock > 0 %}
                <span class="text-xs text-green-400">В наличии: {{ product.stock }} шт.</span>
              {% else %}
                <span class="text-xs text-red-400">Нет в наличии</span>
              {% endif %}
            </div>
            <a href="{% url 'product_detail' product.id %}" class="inline-block w-full text-center rounded-lg bg-blue-700 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-400">Узнать подробнее</a>
          </div>
        </article>
      {% empty %}
        <p class="text-sm text-white/60">Товары пока не добавлены.</p>
      {% endfor %}
    </div>
  </section>
</div>
{% endblock %}
